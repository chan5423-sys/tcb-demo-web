{"version":3,"sources":["web/App.js","index.js"],"names":["App","state","app","loginMsg","userId","errmsg","base64","base64Encoding","execTime","queryResult","queryTime","window","tcb","init","env","auth","this","setState","e","target","value","fetch","then","res","a","console","log","status","Error","statusText","json","data","signInWithTicket","ticket","credential","refreshToken","catch","err","message","start","Date","now","callFunction","name","str","end","result","db","database","collection","get","map","item","JSON","stringify","join","signOut","htmlFor","type","id","onChange","handleInputBase64","style","marginLeft","onClick","getBase64Encoding","marginTop","queryDB","handleInputUserId","customLogin","logout","className","color","renderFunction","renderDataBase","renderCustomLogin","React","Component","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.402e2074.chunk.js","sourcesContent":["import React from 'react';\nimport './App.css';\n\nconst ticketUrl =\n  'https://service-2rliije5-1252710547.ap-shanghai.apigateway.myqcloud.com/release/';\n\nclass App extends React.Component {\n  constructor() {\n    super();\n    this.state = {\n      app: {},\n      loginMsg: '',\n      userId: 'tcb00',\n      errmsg: '',\n      base64: '',\n      base64Encoding: '',\n      execTime: 0,\n      queryResult: '',\n      queryTime: 0\n    };\n  }\n\n  componentDidMount() {\n    const app = window.tcb.init({\n      env: 'scf-920ksf'\n    });\n\n    app.auth();\n\n    this.setState({\n      app\n    });\n  }\n\n  handleInputUserId(e) {\n    this.setState({ userId: e.target.value });\n  }\n\n  handleInputBase64(e) {\n    this.setState({ base64: e.target.value });\n  }\n\n  // 自定义登录\n  customLogin() {\n    const { userId } = this.state;\n\n    if (!userId) {\n      this.setState({\n        userId: 'tcb00'\n      });\n    }\n\n    fetch(`${ticketUrl}?userId=${userId || 'tcb00'}`)\n      .then(async res => {\n        console.log(res);\n        if (res.status === 400) {\n          throw new Error(\n            `${res.status}: ${res.statusText} 获取 Ticket 失败，用户 Id 不符合规则`\n          );\n        }\n\n        if (res.status === 429) {\n          throw new Error(\n            `${res.status}: ${res.statusText} API rate limit exceeded`\n          );\n        }\n        const data = await res.json();\n\n        const auth = this.state.app.auth();\n\n        auth.signInWithTicket(data.ticket).then(res => {\n          if (res && res.credential && res.credential.refreshToken) {\n            this.setState({\n              loginMsg: '登录成功！'\n            });\n          }\n        });\n      })\n      .catch(err => {\n        this.setState({\n          errmsg: err.message\n        });\n      });\n  }\n\n  // 执行函数测试\n  getBase64Encoding() {\n    const { base64 } = this.state;\n    if (!base64) {\n      this.setState({\n        errmsg: 'Base64 字符串不能为空！'\n      });\n      return;\n    }\n\n    const start = Date.now();\n    this.state.app\n      .callFunction({\n        name: 'base64',\n        data: {\n          str: base64\n        }\n      })\n      .then(res => {\n        const end = Date.now();\n        this.setState({\n          execTime: end - start,\n          base64Encoding: res.result.data\n        });\n      })\n      .catch(err => {\n        this.setState({\n          errmsg: err.message\n        });\n      });\n  }\n\n  async queryDB() {\n    try {\n      const start = Date.now();\n      const db = this.state.app.database();\n      const collection = db.collection('demo_web');\n      const res = await collection.get();\n      const end = Date.now();\n      this.setState({\n        queryResult: res.data.map(item => JSON.stringify(item)).join(' /n '),\n        queryTime: end - start\n      });\n    } catch (err) {\n      this.setState({\n        errmsg: err.message\n      });\n    }\n  }\n\n  logout() {\n    this.state.app\n      .auth()\n      .signOut()\n      .then(res => {\n        this.setState({\n          loginMsg: '注销登录成功！'\n        });\n      });\n  }\n\n  renderFunction() {\n    const { base64Encoding, execTime } = this.state;\n\n    return (\n      <div>\n        <h4>Base64 编码</h4>\n        <div>\n          <label htmlFor=\"userId\">字符串：</label>\n          <input\n            type=\"text\"\n            id=\"userId\"\n            value={this.state.base64}\n            onChange={e => this.handleInputBase64(e)}\n          />\n          <button\n            style={{ marginLeft: '10px' }}\n            onClick={() => this.getBase64Encoding()}\n          >\n            计算\n          </button>\n        </div>\n        <div style={{ marginTop: '10px' }}>结果： {base64Encoding}</div>\n        <div style={{ marginTop: '10px' }}>耗时： {execTime} ms</div>\n      </div>\n    );\n  }\n\n  renderDataBase() {\n    const { queryResult, queryTime } = this.state;\n    return (\n      <div>\n        <h4>查询</h4>\n        <div>\n          <button onClick={() => this.queryDB()}>查询记录</button>\n        </div>\n        <div style={{ marginTop: '10px' }}>\n          结果：\n          <br />\n          {queryResult}\n        </div>\n        <div style={{ marginTop: '10px' }}>耗时： {queryTime} ms</div>\n      </div>\n    );\n  }\n\n  renderCustomLogin() {\n    return (\n      <div>\n        <h4>自定义登录</h4>\n        <div>\n          <label htmlFor=\"userId\">用户 Id（字母和数字的组合，4-32 位）：</label>\n          <input\n            type=\"text\"\n            id=\"userId\"\n            value={this.state.userId}\n            onChange={e => this.handleInputUserId(e)}\n          />\n          <button\n            style={{ marginLeft: '10px' }}\n            onClick={() => this.customLogin()}\n          >\n            登录\n          </button>\n          <button style={{ marginLeft: '10px' }} onClick={() => this.logout()}>\n            注销登录\n          </button>\n        </div>\n        <div style={{ marginTop: '10px' }}>{this.state.loginMsg}</div>\n      </div>\n    );\n  }\n\n  render() {\n    const { errmsg } = this.state;\n\n    return (\n      <div className=\"app\">\n        <h3>通过代理访问域名：tcb.dev</h3>\n        <div className=\"err\" style={{ color: 'red' }}>\n          {errmsg}\n        </div>\n        <div className=\"categories\">\n          <div className=\"group\">\n            <div className=\"group-title text-lg text-bold\">函数</div>\n            <div className=\"group-content\">{this.renderFunction()}</div>\n          </div>\n          <div className=\"group\">\n            <div className=\"group-title text-lg text-bold\">数据库</div>\n            <div className=\"group-content\">{this.renderDataBase()}</div>\n          </div>\n          <div className=\"group\">\n            <div className=\"group-title text-lg text-bold\">存储</div>\n            <div className=\"group-content\"></div>\n          </div>\n          <div className=\"group\">\n            <div className=\"group-title text-lg text-bold\">授权</div>\n            <div className=\"group-content\">{this.renderCustomLogin()}</div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './web/index.css';\nimport App from './web/App';\n\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}